// الدالة السحرية التي تشغل الأزرار
function jbc_payload(dataPtr) {
    // 1. تخصيص مساحة للبايلود
    var size = dataPtr.length;
    var codeAddr = window.malloc(size);
    
    // 2. نسخ بيانات ملف الـ .bin إلى الذاكرة
    for (var i = 0; i < size; i++) {
        window.p.write1(codeAddr.addr.add32(i), dataPtr[i]);
    }
    
    // 3. القفز إلى الذاكرة لتشغيل الكود (Execute)
    // ملاحظة: هنا يتم استدعاء وظيفة الـ ROP للقفز للعنوان codeAddr.addr
    run_rop_chain(codeAddr.addr);
}
window.jbc_payload = jbc_payload;
